package uwu.flauxy.module.impl.exploit;

import net.minecraft.network.play.client.C01PacketChatMessage;
import uwu.flauxy.event.Event;
import uwu.flauxy.event.impl.EventSendPacket;
import uwu.flauxy.module.Category;
import uwu.flauxy.module.Module;
import uwu.flauxy.module.ModuleInfo;
import uwu.flauxy.utils.PacketUtil;
import uwu.flauxy.utils.WorldUtil;
import uwu.flauxy.utils.Wrapper;

@ModuleInfo(name = "ChatBypass", displayName = "Chat Bypass", key = -1, cat = Category.Exploit)
public class ChatBypass extends Module {

    @Override
    public void onEvent(Event e) {
        if(e instanceof EventSendPacket){

            if(WorldUtil.shouldNotRun()) return;
            EventSendPacket event = (EventSendPacket) e;
            if(event.getPacket() instanceof C01PacketChatMessage){
                Wrapper.instance.log("Sent");
                C01PacketChatMessage packet = event.getPacket();
                String oldMessage = packet.getMessage();

                String newMessage = oldMessage;
                newMessage = oldMessage.replaceAll("a", "â");
                newMessage = oldMessage.replaceAll("A", "â");
                newMessage = oldMessage.replaceAll("i", "ì");
                newMessage = oldMessage.replaceAll("I", "ì");
                newMessage = oldMessage.replaceAll("e", "e·");
                newMessage = oldMessage.replaceAll("E", "E");
                event.setCancelled(true);
                PacketUtil.packetNoEvent(new C01PacketChatMessage(newMessage));
            }
        }
    }
}
